<div class="container-fluid">
    <h1 class="mt-4">Sản phẩm</h1>
    <ol class="breadcrumb mb-4">
        <li class="breadcrumb-item active">Sản phẩm</li>
    </ol>
    <div class="card mb-4">
        <div class="card-header">
            <i class="fas fa-table mr-1"></i>
            DataTable Example
        </div>
        <div class="d-flex justify-content-center">
            <a href="../products/addnew">
                <button type="button" class="btn aqua-gradient btn-primary"><i class="fas fa-plus"></i>Add new</button>
            </a>
        </div>
        <div class="d-flex ">
            <form action="../products/search" method="GET" class="form-inline md-form mr-auto mb-4">
                <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search"
                    name="searchedproduct">
                <button class="btn aqua-gradient btn-rounded btn-sm my-0" type="submit">Search</button>
            </form>
            <div class="dropdown">
                <button class="btn btn-primary aqua-gradient dropdown-toggle" type="button" data-toggle="dropdown">Find by category
                    <span class="caret"></span></button>
                <ul class="dropdown-menu">
                    <li><a href="/products/category?category=foods&page=1">foods</a></li>
                    <li><a href="/products/category?category=drinks&page=1">drinks</a></li>
                    <li><a href="/products/category?category=desserts&page=1">desserts</a></li>
                </ul>
            </div>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                    <thead>
                        <tr>
                            <th>Tên</th>
                            <th>Loại</th>
                            <th>Giá</th>
                            <th>Chỉnh sửa</th>
                        </tr>
                    </thead>
                    <tfoot>
                        <tr>
                            <th>Tên</th>
                            <th>Loại</th>
                            <th>Giá</th>
                            <th>Chỉnh sửa</th>
                        </tr>
                    </tfoot>
                    <tbody>

                        {{#each productsbycategory}}
                        <tr>
                            <td>{{title}}</td>
                            <td>{{category}}</td>
                            <td>{{basePrice}}</td>
                            <td>
                                <a href="../products/detail.{{_id}}">
                                    <i class="fas fa-edit text-success"></i>
                                </a>
                                <a>
                                    <i class="fas fa-trash text-danger"
                                        onclick="delete_product(&quot;{{title}}&quot;,'foods')"></i>
                                </a>
                            </td>
                        </tr>
                        {{/each}}

                    </tbody>
                </table>

            </div>
        </div>
        <div class="d-flex justify-content-center">
            {{{paginateHelper pagination}}}
        </div>

    </div>
</div>
<script>
    function delete_product(title, type) {
        const form = document.createElement("form");
        form.method = "post";
        form.action = "./delete";

        const inputTitle = document.createElement("input");
        inputTitle.name = "title";
        inputTitle.value = title;
        form.appendChild(inputTitle);

        const inputType = document.createElement("input");
        inputType.name = "type";
        inputType.value = type;
        form.appendChild(inputType);

        document.body.appendChild(form);

        form.submit();
    }
</script>
